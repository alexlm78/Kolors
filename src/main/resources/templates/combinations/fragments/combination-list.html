<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
</head>
<body>
    <!-- Combination List Fragment -->
    <div th:fragment="combinationList">
        <div class="combinations-grid" th:if="${combinations != null and !combinations.empty}">
            <div class="combination-card" th:each="combination : ${combinations}">
                <div class="combination-name" th:text="${combination.name}">Nombre</div>
                <div class="combination-meta">
                    <span th:text="${combination.colorCount}">2</span> colores •
                    <span th:text="${#temporals.format(combination.createdAt, 'dd/MM/yyyy')}">01/01/2024</span>
                </div>
                <div class="combination-colors">
                    <div class="combination-color" th:each="color : ${combination.colors}"
                         th:style="'background-color: #' + ${color.hexValue}"
                         th:data-hex="${'#' + color.hexValue}"
                         th:title="${'#' + color.hexValue}">
                    </div>
                </div>
                <div class="combination-actions">
                    <a th:href="@{/combinations/{id}(id=${combination.id})}" class="btn btn-secondary btn-sm">Ver</a>
                    <a th:href="@{/combinations/{id}/edit(id=${combination.id})}"
                       class="btn btn-secondary btn-sm">Editar</a>
                    <a th:href="@{/combinations/{id}/confirm-delete(id=${combination.id})}"
                       class="btn btn-danger btn-sm">Eliminar</a>
                </div>
            </div>
        </div>

        <!-- Empty State -->
        <div th:if="${combinations == null or combinations.empty}" class="text-center" style="padding: 40px;">
            <h3 style="color: #6c757d; margin-bottom: 10px;">No se encontraron combinaciones</h3>
            <p style="color: #6c757d;">
                No hay combinaciones que coincidan con los criterios de búsqueda.
            </p>
        </div>
    </div>

    <!-- Search Results Info Fragment -->
    <div th:fragment="searchResultsInfo">
        <div class="search-results-info" th:if="${totalCombinations != null}">
            <p class="results-count">
                <span th:text="${totalCombinations}">0</span> combinaciones encontradas
                <span th:if="${search != null and !search.isEmpty()}" class="search-term">
                    para "<strong th:text="${search}"></strong>"
                </span>
                <span th:if="${colorCount != null}" class="filter-info">
                    con <strong th:text="${colorCount}"></strong> colores
                </span>
                <span th:if="${minColors != null and maxColors != null}" class="filter-info">
                    con <strong th:text="${minColors}"></strong> a <strong th:text="${maxColors}"></strong> colores
                </span>
                <span th:if="${hexValue != null and !hexValue.isEmpty()}" class="filter-info">
                    conteniendo color <strong th:text="'#' + ${hexValue}"></strong>
                </span>
            </p>
        </div>
    </div>

    <!-- Pagination Fragment -->
    <div th:fragment="paginationControls">
        <div class="pagination-controls" th:if="${totalPages != null and totalPages > 1}">
            <div class="pagination-info">
                Página <span th:text="${currentPage + 1}">1</span> de <span th:text="${totalPages}">1</span>
            </div>
            <div class="pagination-buttons">
                <a th:if="${hasPrevious}"
                   th:href="@{/combinations/paginated(search=${search}, colorCount=${colorCount}, minColors=${minColors}, maxColors=${maxColors}, hexValue=${hexValue}, page=${currentPage - 1}, size=${pageSize})}"
                   class="btn btn-secondary btn-sm">« Anterior</a>

                <span th:each="pageNum : ${#numbers.sequence(0, totalPages - 1)}"
                      th:if="${pageNum >= (currentPage - 2) and pageNum <= (currentPage + 2)}">
                   <a th:if="${pageNum != currentPage}"
                      th:href="@{/combinations/paginated(search=${search}, colorCount=${colorCount}, minColors=${minColors}, maxColors=${maxColors}, hexValue=${hexValue}, page=${pageNum}, size=${pageSize})}"
                      th:text="${pageNum + 1}"
                      class="btn btn-secondary btn-sm">1</a>
                   <span th:if="${pageNum == currentPage}"
                         th:text="${pageNum + 1}"
                         class="btn btn-primary btn-sm current-page">1</span>
                </span>

                <a th:if="${hasNext}"
                   th:href="@{/combinations/paginated(search=${search}, colorCount=${colorCount}, minColors=${minColors}, maxColors=${maxColors}, hexValue=${hexValue}, page=${currentPage + 1}, size=${pageSize})}"
                   class="btn btn-secondary btn-sm">Siguiente »</a>
            </div>
        </div>
    </div>
</body>
</html>
